<%init>

    # Set up application-specific parts
    my $ApplicationClass = Jifty->config->framework('ApplicationClass');
    # This creates a sub "models" which when called, finds packages under
    # $ApplicationClass::Model, requires them, and returns a list of their
    # names.
       

        my @models;   

    Module::Pluggable->import(
        require     => 1,
        search_path => [  $ApplicationClass . "::Model" ],
        sub_name    => 'jifty_app_models',
    );

        for my $model ( __PACKAGE__->jifty_app_models ) {

            # We don't want to get the Collections, or models that have a
            # 'since' that is after the current application version.

       # TODO XXX FIXME:
       #   This *will* try to generate SQL for abstract base classes you might
       #   stick in $AC::Model::.
                next if not UNIVERSAL::isa( $model, 'Jifty::Record' );
        push @models, $model


        }

my $nav = Jifty->web->navigation->child("Administration");
 foreach my $model (@models) {
 next unless ($model =~ /^(?:.*)::(.*?)$/);
 my $type = $1;
 $nav->child($type   => url => '/__jifty/admin/'.$type);
 }
 return;
</%init>
